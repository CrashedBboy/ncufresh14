(function(e){e(document).ready(function(){function r(t,n){ajaxPost(e("#gameShopItems").attr("action"),{itemId:t},function(r){if(r["hadbuy"]==0){if(r["isBuy"]){n.addClass("itemHadBuy");editStatus(r["user"]["power"],r["user"]["gp"]);e.alertMessage("購買成功!");if(t==42){e("#characterSpecial").attr("src",bURL+"images/gameShop/special/real-special.png")}}else{e.alertMessage("你GP不夠喔！")}}})}function i(){e(".gameShopItemImage").each(function(r){e(this).click(function(){e(".gameShopItemSpecial").each(function(t){e(this).removeClass("gameShopItemSelectSpecial")});if(t<4){if(n){o[0].attr("src",bURL+"images/gameShop/head/1.png");o[0].attr("itemId",1);o[1].attr("src",bURL+"images/gameShop/face/1.png");o[1].attr("itemId",7);o[2].attr("src",bURL+"images/gameShop/body/1.png");o[2].attr("itemId",13);o[3].attr("src",bURL+"images/gameShop/foot/1.png");o[3].attr("itemId",19)}o[6].hide();n=false;for(var r=0;r<4;r++){o[r].show()}}o[t].attr("src",e(this).attr("src"));o[t].attr("itemId",e(this).attr("itemId"));e(".gameShopItem").each(function(t){e(this).removeClass("gameShopItemSelect")});e(this).parent().addClass("gameShopItemSelect");if(t==0){o[1].css({top:disply_item_data[o[0].attr("itemId")-1]["face_middle_y"]/2-35+"px",left:disply_item_data[o[0].attr("itemId")-1]["face_middle_x"]/2+17+"px"})}for(var r=4;r<6;r++){if(o[r].attr("itemId")==0){o[r].hide()}else{o[r].show()}}})});e("#gameShopItemImageSpecial").click(function(){e(".gameShopItem").each(function(t){e(this).removeClass("gameShopItemSelect")});e(this).parent().addClass("gameShopItemSelectSpecial");for(var t=0;t<4;t++){o[t].hide();o[t].attr("itemId",e(this).attr("itemId"))}for(var t=4;t<6;t++){if(o[t].attr("itemId")==0){o[t].hide()}else{o[t].show()}}o[6].show();n=true})}function s(){e(".gameShopItemBuyButton").each(function(t){e(this).click(function(){r(e(this).attr("item"),e(this))})});e(".gameShopItemBuyButtonSpecial").click(function(){r(e(this).attr("item"),e(this))})}var t=0;var n=false;e(".gameShopTypeButton").each(function(r){e(this).click(function(){ajaxPost(e(this).attr("action"),{type:r},function(o){t=r;e("#gameShopItems .jspPane .gameShopItem").remove();if(t==4||t==5){e(".gameShopItemSpecial").hide()}else{e(".gameShopItemSpecial").show()}e("#gameShopItems").jScrollPane();for(var f=0;f<o["shop"].length;f++){if(o["shop"][f]["id"]!=42){var l="";if(o["hadBuyItems"][f]==true){l="itemHadBuy"}var c="";for(var h=0;h<6;h++){if(Equip_items[h]["id"]==o["shop"][f]["id"])c="gameShopItemSelect";if(a[u[h]][0]==o["shop"][f]["id"])c="gameShopItemSelect"}if(n&&t!=4&&t!=5){c=""}e('<div class="gameShopItem '+c+'">'+'<img class="gameShopItemImage" src="'+bURL+"images/gameShop/"+o["shop"][f]["picture"]+'" itemId="'+o["shop"][f]["id"]+'" />'+'<div class="gameShopItemText">gp '+o["shop"][f]["costgp"]+"</div>"+'<div class="gameShopItemBuyButton '+l+'" item="'+o["shop"][f]["id"]+'"></div>'+"</div>").appendTo(e("#gameShopItems .jspPane"))}}e("#gameShopItems").jScrollPane();i();s()})})});var o=new Array(7);var u=["head","face","body","foot","item","map"];var a=[];e(".character").each(function(t){o[t]=e(this);a[u[t]]=[o[t].attr("itemId"),o[t].attr("src")]});for(var f=0;f<6;f++){if(f<4){if(o[f].attr("itemId")!=42){o[f].show()}else{o[6].show();n=true;e(".gameShopItemSpecial").each(function(t){e(this).addClass("gameShopItemSelectSpecial")})}}else{if(Equip_items[f]["id"]!=0)o[f].show()}}e("#characterEquipButton").click(function(){var t=new Array(6);for(var n=0;n<6;n++){t[n]=o[n].attr("itemId")}ajaxPost(e(this).attr("action"),{user_want:t},function(n){var r=true;for(var i=0;i<6;i++){if(!n["isBuy"][i]){var s=["頭盔","表情","身體","下肢","道具","地圖碎片"];if(t[i]!=0){e.alertMessage("你還沒買"+s[i]+"喔~")}r=false;o[i].attr("itemId",a[u[i]][0]);o[i].attr("src",a[u[i]][1])}else{a[u[i]]=[o[i].attr("itemId"),o[i].attr("src")]}}if(r){e.alertMessage("成功裝備!",{type:"alert-danger"})}else{e.alertMessage("其餘裝備成功裝備!")}})});e("#characterReturnButton").click(function(){if(a["head"][0]==42){o[6].show();for(var r=0;r<4;r++){o[r].hide()}n=true}else{o[6].hide();for(var r=0;r<4;r++){o[r].attr("itemId",a[u[r]][0]);o[r].attr("src",a[u[r]][1]);o[r].show()}o[1].css({top:disply_item_data[o[0].attr("itemId")-1]["face_middle_y"]/2-35+"px",left:disply_item_data[o[0].attr("itemId")-1]["face_middle_x"]/2+17+"px"});n=false}for(var r=4;r<6;r++){if(a[u[r]][0]!=0){o[r].attr("itemId",a[u[r]][0]);o[r].attr("src",a[u[r]][1])}else{o[r].hide()}}e(".gameShopItem").each(function(n){e(this).removeClass("gameShopItemSelect");if(e(this).children(".gameShopItemImage").attr("itemId")==a[u[t]][0]){e(this).addClass("gameShopItemSelect")}});e(".gameShopItemSpecial").each(function(t){e(this).removeClass("gameShopItemSelectSpecial")});if(a["head"][0]==42){e(".gameShopItemSpecial").each(function(t){e(this).addClass("gameShopItemSelectSpecial")})}});e("#gameShopItems").jScrollPane();i();s()})})(jQuery)